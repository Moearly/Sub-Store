# Sub-Store é¡¹ç›®åˆ†ææ–‡æ¡£

> ç‰ˆæœ¬ï¼šv2.20.47  
> é¡¹ç›®åœ°å€ï¼šhttps://github.com/sub-store-org/Sub-Store  
> å®˜æ–¹æ–‡æ¡£ï¼šhttps://xream.notion.site/Sub-Store-abe6a96944724dc6a36833d5c9ab7c87

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

**Sub-Store** æ˜¯ä¸€ä¸ªé«˜çº§ä»£ç†è®¢é˜…ç®¡ç†å·¥å…·ï¼Œä¸“ä¸ºä»£ç†å®¢æˆ·ç«¯è®¾è®¡ï¼Œæ”¯æŒè®¢é˜…æ ¼å¼è½¬æ¢ã€èŠ‚ç‚¹è¿‡æ»¤ã€å¤šè®¢é˜…åˆå¹¶ç­‰åŠŸèƒ½ã€‚

### æ”¯æŒçš„å®¢æˆ·ç«¯

| å®¢æˆ·ç«¯ | å¹³å° | æ”¯æŒçŠ¶æ€ |
|--------|------|----------|
| Quantumult X (QX) | iOS | âœ… å®Œæ•´æ”¯æŒ |
| Loon | iOS | âœ… å®Œæ•´æ”¯æŒ |
| Surge | iOS/macOS | âœ… å®Œæ•´æ”¯æŒ |
| Stash | iOS | âœ… å®Œæ•´æ”¯æŒ |
| Egern | iOS | âœ… å®Œæ•´æ”¯æŒ |
| Shadowrocket | iOS | âœ… å®Œæ•´æ”¯æŒ |
| Clash.Meta (mihomo) | å¤šå¹³å° | âœ… å®Œæ•´æ”¯æŒ |
| sing-box | å¤šå¹³å° | âœ… å®Œæ•´æ”¯æŒ |
| V2Ray | å¤šå¹³å° | âœ… å®Œæ•´æ”¯æŒ |

---

## äºŒã€æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 2.1 è®¢é˜…æ ¼å¼è½¬æ¢

Sub-Store çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åœ¨ä¸åŒä»£ç†å®¢æˆ·ç«¯æ ¼å¼ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚

#### æ”¯æŒçš„è¾“å…¥æ ¼å¼

| æ ¼å¼ç±»å‹ | å…·ä½“åè®®/æ ¼å¼ |
|----------|---------------|
| **URI åè®®** | socks5, socks5+tls, http, https |
| **æ ‡å‡† URI** | AnyTLS, SOCKS, SS, SSR, VMess, VLESS, Trojan, Hysteria, Hysteria 2, TUIC v5, WireGuard |
| **Clash æ ¼å¼** | Clash Proxies YAML, Clash Proxy JSON (å•è¡Œ) |
| **QX æ ¼å¼** | SS, SSR, VMess, Trojan, HTTP, SOCKS5, VLESS |
| **Loon æ ¼å¼** | SS, SSR, VMess, Trojan, HTTP, SOCKS5, SOCKS5-TLS, WireGuard, VLESS, Hysteria 2 |
| **Surge æ ¼å¼** | Direct, SS, VMess, Trojan, HTTP, SOCKS5, SOCKS5-TLS, TUIC, Snell, Hysteria 2, SSH, WireGuard |
| **Surfboard æ ¼å¼** | SS, VMess, Trojan, HTTP, SOCKS5, SOCKS5-TLS, WireGuard |
| **Clash.Meta æ ¼å¼** | Direct, SS, SSR, VMess, Trojan, HTTP, SOCKS5, Snell, VLESS, WireGuard, Hysteria, Hysteria 2, TUIC, SSH, mieru, sudoku, AnyTLS |
| **Stash æ ¼å¼** | SS, SSR, VMess, Trojan, HTTP, SOCKS5, Snell, VLESS, WireGuard, Hysteria, TUIC, Juicity, SSH |

#### æ”¯æŒçš„è¾“å‡ºå¹³å°

| å¹³å° | è¯´æ˜ |
|------|------|
| Plain JSON | çº¯ JSON æ ¼å¼è¾“å‡º |
| Stash | Stash å®¢æˆ·ç«¯æ ¼å¼ |
| Clash.Meta (mihomo) | Clash Meta å†…æ ¸æ ¼å¼ |
| Surfboard | Surfboard å®¢æˆ·ç«¯æ ¼å¼ |
| Surge | Surge iOS æ ¼å¼ |
| SurgeMac | Surge macOS æ ¼å¼ï¼ˆä½¿ç”¨ mihomo æ”¯æŒé¢å¤–åè®®ï¼‰ |
| Loon | Loon å®¢æˆ·ç«¯æ ¼å¼ |
| Egern | Egern å®¢æˆ·ç«¯æ ¼å¼ |
| Shadowrocket | Shadowrocket å®¢æˆ·ç«¯æ ¼å¼ |
| QX | Quantumult X æ ¼å¼ |
| sing-box | sing-box æ ¸å¿ƒæ ¼å¼ |
| V2Ray | V2Ray é…ç½®æ ¼å¼ |
| V2Ray URI | V2Ray é“¾æ¥æ ¼å¼ |

---

### 2.2 è®¢é˜…æ ¼å¼åŒ–å¤„ç†

#### è¿‡æ»¤å™¨ (Filters)

| è¿‡æ»¤å™¨ç±»å‹ | åŠŸèƒ½è¯´æ˜ |
|------------|----------|
| **Regex filter** | æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼Œä¿ç•™åŒ¹é…çš„èŠ‚ç‚¹ |
| **Discard regex filter** | æ’é™¤æ­£åˆ™è¿‡æ»¤ï¼Œç§»é™¤åŒ¹é…çš„èŠ‚ç‚¹ |
| **Region filter** | åœ°åŒºè¿‡æ»¤ï¼ŒæŒ‰å›½å®¶/åœ°åŒºç­›é€‰ |
| **Type filter** | ç±»å‹è¿‡æ»¤ï¼ŒæŒ‰åè®®ç±»å‹ç­›é€‰ |
| **Useless proxies filter** | æ— æ•ˆèŠ‚ç‚¹è¿‡æ»¤ï¼Œç§»é™¤ä¸å¯ç”¨èŠ‚ç‚¹ |
| **Script filter** | è„šæœ¬è¿‡æ»¤ï¼Œä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬ç­›é€‰ |

#### èŠ‚ç‚¹æ“ä½œ (Proxy Operations)

| æ“ä½œç±»å‹ | åŠŸèƒ½è¯´æ˜ |
|----------|----------|
| **Set property operator** | è®¾ç½®èŠ‚ç‚¹å±æ€§ï¼ˆudpã€tfoã€skip-cert-verify ç­‰ï¼‰ |
| **Flag operator** | æ·»åŠ æˆ–ç§»é™¤èŠ‚ç‚¹åç§°ä¸­çš„å›½æ—— emoji |
| **Sort operator** | æŒ‰åç§°æ’åºèŠ‚ç‚¹ |
| **Regex sort operator** | æŒ‰å…³é”®è¯æ­£åˆ™æ’åºï¼ˆæ”¯æŒå›é€€åˆ°æ™®é€šæ’åºï¼‰ |
| **Regex rename operator** | æ­£åˆ™é‡å‘½åï¼Œæ›¿æ¢èŠ‚ç‚¹åç§°ä¸­çš„å†…å®¹ |
| **Regex delete operator** | æ­£åˆ™åˆ é™¤ï¼Œç§»é™¤èŠ‚ç‚¹åç§°ä¸­çš„å†…å®¹ |
| **Script operator** | è„šæœ¬æ“ä½œï¼Œä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬ä¿®æ”¹èŠ‚ç‚¹ |
| **Resolve Domain Operator** | åŸŸåè§£æï¼Œå°†èŠ‚ç‚¹åŸŸåè§£æä¸º IP åœ°å€ |

---

### 2.3 å¤šè®¢é˜…åˆå¹¶

å°†å¤šä¸ªè®¢é˜…æºæ•´åˆä¸ºä¸€ä¸ªç»Ÿä¸€çš„è®¢é˜…é“¾æ¥ã€‚

#### è®¢é˜…ç±»å‹

| ç±»å‹ | è¯´æ˜ |
|------|------|
| **å•æ¡è®¢é˜… (Subscription)** | ç®¡ç†å•ä¸ªè®¢é˜…æºï¼Œæ”¯æŒæœ¬åœ°å’Œè¿œç¨‹ |
| **ç»„åˆè®¢é˜… (Collection)** | åˆå¹¶å¤šä¸ªå•æ¡è®¢é˜…ä¸ºä¸€ä¸ª |
| **è®¢é˜…æ ‡ç­¾** | é€šè¿‡æ ‡ç­¾è‡ªåŠ¨åˆ†ç»„ç®¡ç†è®¢é˜… |

#### åˆå¹¶æ¨¡å¼

- **localFirst**: æœ¬åœ°å†…å®¹ä¼˜å…ˆï¼Œè¿œç¨‹å†…å®¹è¿½åŠ 
- **remoteFirst**: è¿œç¨‹å†…å®¹ä¼˜å…ˆï¼Œæœ¬åœ°å†…å®¹è¿½åŠ 

---

### 2.4 åŒæ­¥ä¸å¤‡ä»½

#### Gist åŒæ­¥

- æ”¯æŒ GitHub Gist å’Œ GitLab Snippet
- å°†å¤„ç†åçš„é…ç½®è‡ªåŠ¨ä¸Šä¼ åˆ°äº‘ç«¯
- ç”Ÿæˆæ°¸ä¹…å¯ç”¨çš„è®¢é˜…é“¾æ¥

#### å®šæ—¶ä»»åŠ¡

| ç¯å¢ƒå˜é‡ | åŠŸèƒ½ |
|----------|------|
| `SUB_STORE_BACKEND_SYNC_CRON` | å®šæ—¶åŒæ­¥æ‰€æœ‰é…ç½®åˆ° Gist |
| `SUB_STORE_PRODUCE_CRON` | å®šæ—¶å¤„ç†æŒ‡å®šè®¢é˜… |
| `SUB_STORE_BACKEND_DOWNLOAD_CRON` | å®šæ—¶ä» Gist ä¸‹è½½å¤‡ä»½ |
| `SUB_STORE_BACKEND_UPLOAD_CRON` | å®šæ—¶ä¸Šä¼ å¤‡ä»½åˆ° Gist |
| `SUB_STORE_MMDB_CRON` | å®šæ—¶æ›´æ–° GeoIP æ•°æ®åº“ |

---

## ä¸‰ã€æŠ€æœ¯æ¶æ„

### 3.1 é¡¹ç›®ç»“æ„

```
Sub-Store/
â”œâ”€â”€ backend/                    # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.js            # å…¥å£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ constants.js       # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ app.js         # åº”ç”¨å®ä¾‹
â”‚   â”‚   â”‚   â”œâ”€â”€ proxy-utils/   # ä»£ç†å¤„ç†å·¥å…·
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ parsers/   # è§£æå™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ processors/# å¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ producers/ # ç”Ÿæˆå™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ preprocessors/ # é¢„å¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ validators/# éªŒè¯å™¨
â”‚   â”‚   â”‚   â””â”€â”€ rule-utils/    # è§„åˆ™å¤„ç†å·¥å…·
â”‚   â”‚   â”œâ”€â”€ restful/           # RESTful API
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js       # API è·¯ç”±æ³¨å†Œ
â”‚   â”‚   â”‚   â”œâ”€â”€ subscriptions.js # è®¢é˜…ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ collections.js # ç»„åˆè®¢é˜…
â”‚   â”‚   â”‚   â”œâ”€â”€ artifacts.js   # åŒæ­¥é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ sync.js        # åŒæ­¥åŠŸèƒ½
â”‚   â”‚   â”‚   â”œâ”€â”€ settings.js    # è®¾ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ file.js        # æ–‡ä»¶ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ module.js      # æ¨¡å—ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ database.js    # æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ download.js    # ä¸‹è½½åŠŸèƒ½
â”‚   â”‚   â”‚   â”œâ”€â”€ geo.js         # åœ°ç†ä½ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ gist.js        # Gist æ“ä½œ
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ vendor/            # ç¬¬ä¸‰æ–¹åº“é€‚é…
â”‚   â”œâ”€â”€ package.json           # ä¾èµ–é…ç½®
â”‚   â””â”€â”€ dist/                  # æ„å»ºè¾“å‡º
â”œâ”€â”€ config/                    # å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ Loon.plugin           # Loon æ’ä»¶
â”‚   â”œâ”€â”€ Surge.sgmodule        # Surge æ¨¡å—
â”‚   â”œâ”€â”€ QX.snippet            # QX é‡å†™
â”‚   â”œâ”€â”€ Stash.stoverride      # Stash è¦†å†™
â”‚   â””â”€â”€ Egern.yaml            # Egern æ¨¡å—
â””â”€â”€ scripts/                   # ç¤ºä¾‹è„šæœ¬
    â”œâ”€â”€ demo.js               # æ¼”ç¤ºè„šæœ¬
    â”œâ”€â”€ ip-flag.js            # IP æ·»åŠ æ——å¸œ
    â””â”€â”€ ...
```

### 3.2 æ ¸å¿ƒå¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Sub-Store å¤„ç†æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ åŸå§‹è®¢é˜… â”‚ -> â”‚  é¢„å¤„ç†å™¨   â”‚ -> â”‚ è§£æå™¨  â”‚ -> â”‚ ç»Ÿä¸€ä»£ç†å¯¹è±¡æ ¼å¼ â”‚   â”‚
â”‚  â”‚ (å„ç§æ ¼å¼)â”‚    â”‚(Preprocessor)â”‚   â”‚(Parser) â”‚    â”‚   (Proxy[])     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚             â”‚
â”‚                                                            â–¼             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        å¤„ç†å™¨ (Processor)                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚  â”‚ è¿‡æ»¤å™¨   â”‚  â”‚ æ’åºå™¨   â”‚  â”‚ é‡å‘½åå™¨ â”‚  â”‚ è„šæœ¬å¤„ç† â”‚  ...       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚                               â”‚
â”‚                                          â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ç”Ÿæˆå™¨ (Producer)                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ â”‚
â”‚  â”‚  â”‚ Surge â”‚ â”‚ Clash â”‚ â”‚ Loon â”‚ â”‚ QX â”‚ â”‚ sing-box â”‚ â”‚ V2Ray  â”‚ ...  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚                               â”‚
â”‚                                          â–¼                               â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                               â”‚ ç›®æ ‡å¹³å°é…ç½®è¾“å‡º â”‚                        â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 RESTful API æ¥å£

#### è®¢é˜…ç®¡ç†

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/subs` | è·å–æ‰€æœ‰è®¢é˜… |
| POST | `/api/subs` | åˆ›å»ºè®¢é˜… |
| PUT | `/api/subs` | æ›¿æ¢æ‰€æœ‰è®¢é˜… |
| GET | `/api/sub/:name` | è·å–æŒ‡å®šè®¢é˜… |
| PATCH | `/api/sub/:name` | æ›´æ–°æŒ‡å®šè®¢é˜… |
| DELETE | `/api/sub/:name` | åˆ é™¤æŒ‡å®šè®¢é˜… |
| GET | `/api/sub/flow/:name` | è·å–è®¢é˜…æµé‡ä¿¡æ¯ |

#### ç»„åˆè®¢é˜…ç®¡ç†

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/collections` | è·å–æ‰€æœ‰ç»„åˆè®¢é˜… |
| POST | `/api/collections` | åˆ›å»ºç»„åˆè®¢é˜… |
| GET | `/api/collection/:name` | è·å–æŒ‡å®šç»„åˆè®¢é˜… |
| PATCH | `/api/collection/:name` | æ›´æ–°æŒ‡å®šç»„åˆè®¢é˜… |
| DELETE | `/api/collection/:name` | åˆ é™¤æŒ‡å®šç»„åˆè®¢é˜… |

#### åŒæ­¥ç®¡ç†

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/sync/artifacts` | åŒæ­¥æ‰€æœ‰é…ç½® |
| GET | `/api/sync/artifact/:name` | åŒæ­¥æŒ‡å®šé…ç½® |

#### ä¸‹è½½/é¢„è§ˆ

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/download/sub/:name` | ä¸‹è½½è®¢é˜…ï¼ˆè½¬æ¢åï¼‰ |
| GET | `/download/collection/:name` | ä¸‹è½½ç»„åˆè®¢é˜…ï¼ˆè½¬æ¢åï¼‰ |
| GET | `/api/preview/sub/:name` | é¢„è§ˆè®¢é˜…èŠ‚ç‚¹ |
| GET | `/api/preview/collection/:name` | é¢„è§ˆç»„åˆè®¢é˜…èŠ‚ç‚¹ |

---

## å››ã€ä¾èµ–æŠ€æœ¯æ ˆ

### åç«¯ä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| express | ^4.17.1 | Web æ¡†æ¶ |
| lodash | ^4.17.21 | å·¥å…·åº“ |
| js-base64 | ^3.7.2 | Base64 ç¼–è§£ç  |
| static-js-yaml | ^1.0.0 | YAML è§£æ |
| json5 | ^2.2.3 | JSON5 è§£æ |
| cron | ^3.1.6 | å®šæ—¶ä»»åŠ¡ |
| undici | ^7.4.0 | HTTP å®¢æˆ·ç«¯ |
| @maxmind/geoip2-node | ^5.0.0 | GeoIP æŸ¥è¯¢ |
| ip-address | ^9.0.5 | IP åœ°å€å¤„ç† |
| nanoid | ^3.3.3 | ID ç”Ÿæˆ |

### å¼€å‘ä¾èµ–

| ä¾èµ– | ç”¨é€” |
|------|------|
| esbuild | ä»£ç æ‰“åŒ… |
| gulp | æ„å»ºå·¥å…· |
| babel | ä»£ç è½¬è¯‘ |
| mocha/chai | æµ‹è¯•æ¡†æ¶ |
| peggy | è¯­æ³•è§£æå™¨ç”Ÿæˆ |

---

## äº”ã€éƒ¨ç½²æŒ‡å—

### 5.1 å®¢æˆ·ç«¯å†…éƒ¨ç½²ï¼ˆæ¨èï¼‰

ç›´æ¥åœ¨ä»£ç†å®¢æˆ·ç«¯ä¸­å®‰è£…å¯¹åº”çš„æ¨¡å—/æ’ä»¶ï¼š

#### Loon

```
æ’ä»¶åœ°å€ï¼šhttps://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Loon.plugin
```

#### Surge

```
# é»˜è®¤ç‰ˆï¼ˆæ”¯æŒç¼–è¾‘å‚æ•°ï¼‰
https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Surge.sgmodule

# Beta ç‰ˆï¼ˆæ”¯æŒæœ€æ–°ç‰¹æ€§ï¼‰
https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Surge-Beta.sgmodule

# å¸¦ ability å‚æ•°ç‰ˆï¼ˆç”¨äºæŒ‡å®šèŠ‚ç‚¹åŠŸèƒ½ï¼‰
https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Surge-ability.sgmodule

# ä¸å¸¦ ability å‚æ•°ç‰ˆ
https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Surge-Noability.sgmodule
```

#### Quantumult X

```
é‡å†™åœ°å€ï¼šhttps://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/QX.snippet
å®šæ—¶ä»»åŠ¡ï¼šhttps://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/QX-Task.json
```

#### Stash

```
è¦†å†™åœ°å€ï¼šhttps://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Stash.stoverride
```

#### Shadowrocket

```
æ¨¡å—åœ°å€ï¼šhttps://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Surge-Noability.sgmodule
```

#### Egern

```
æ¨¡å—åœ°å€ï¼šhttps://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Egern.yaml
```

å®‰è£…åè®¿é—® **https://sub.store** å³å¯ä½¿ç”¨ Web ç•Œé¢ã€‚

---

### 5.2 æœåŠ¡å™¨éƒ¨ç½²

#### æœåŠ¡å™¨éœ€æ±‚

##### æœ€ä½é…ç½®

| èµ„æº | æœ€ä½è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| **CPU** | 1 æ ¸ | å•æ ¸å³å¯è¿è¡Œ |
| **å†…å­˜** | 256MB | åŸºç¡€è¿è¡Œå†…å­˜ |
| **å­˜å‚¨** | 500MB | åŒ…å« Node.jsã€ä¾èµ–å’Œæ•°æ® |
| **ç½‘ç»œ** | éœ€è¦å…¬ç½‘ IP æˆ–åŸŸå | ç”¨äºè®¢é˜…é“¾æ¥è®¿é—® |
| **ç³»ç»Ÿ** | Linux/Windows/macOS | æ”¯æŒ Node.js çš„ç³»ç»Ÿå‡å¯ |

##### æ¨èé…ç½®

| èµ„æº | æ¨èé…ç½® | è¯´æ˜ |
|------|----------|------|
| **CPU** | 1-2 æ ¸ | å¤„ç†å¤§é‡è®¢é˜…æ—¶æ›´æµç•… |
| **å†…å­˜** | 512MB - 1GB | å¤„ç†å¤æ‚è„šæœ¬å’Œå¤§è®¢é˜…éœ€è¦æ›´å¤šå†…å­˜ |
| **å­˜å‚¨** | 1GB+ | åŒ…å« GeoIP æ•°æ®åº“å’Œç¼“å­˜ |
| **å¸¦å®½** | 1Mbps+ | å–å†³äºç”¨æˆ·æ•°é‡å’Œè®¢é˜…æ›´æ–°é¢‘ç‡ |

##### èµ„æºæ¶ˆè€—åˆ†æ

| åœºæ™¯ | CPU å ç”¨ | å†…å­˜å ç”¨ | è¯´æ˜ |
|------|----------|----------|------|
| **ç©ºé—²çŠ¶æ€** | < 1% | ~50-80MB | Node.js è¿›ç¨‹åŸºç¡€å ç”¨ |
| **å•æ¬¡è®¢é˜…è½¬æ¢** | 5-20% | ~100-150MB | å–å†³äºèŠ‚ç‚¹æ•°é‡ |
| **å¤§é‡èŠ‚ç‚¹å¤„ç†** | 20-50% | ~200-400MB | å¤„ç† 500+ èŠ‚ç‚¹æ—¶ |
| **è„šæœ¬æ“ä½œ** | 10-30% | ~150-300MB | æ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬ |
| **GeoIP æŸ¥è¯¢** | 5-15% | +50-100MB | åŠ è½½ MMDB æ•°æ®åº“ |

##### æ³¨æ„äº‹é¡¹

1. **å†…å­˜æ•æ„Ÿ**ï¼šå¤„ç†å¤§é‡èŠ‚ç‚¹æˆ–å¤æ‚è„šæœ¬æ—¶å†…å­˜æ¶ˆè€—è¾ƒå¤§
2. **ç½‘ç»œä¾èµ–**ï¼šéœ€è¦èƒ½è®¿é—®è®¢é˜…æº URLï¼ˆå¯èƒ½éœ€è¦ä»£ç†ï¼‰
3. **å­˜å‚¨å¢é•¿**ï¼šç¼“å­˜å’Œæ—¥å¿—ä¼šéšæ—¶é—´å¢é•¿ï¼Œå»ºè®®å®šæœŸæ¸…ç†
4. **å¹¶å‘å¤„ç†**ï¼šå¤šç”¨æˆ·åŒæ—¶è¯·æ±‚æ—¶èµ„æºæ¶ˆè€—ä¼šå åŠ 

##### é€‚åˆçš„æœåŠ¡å™¨ç±»å‹

| æœåŠ¡å™¨ç±»å‹ | é€‚ç”¨åœºæ™¯ | é¢„ä¼°æˆæœ¬ |
|------------|----------|----------|
| **VPS æœ€ä½é…** | ä¸ªäººä½¿ç”¨ï¼Œå°‘é‡è®¢é˜… | $3-5/æœˆ |
| **VPS å…¥é—¨é…** | å®¶åº­/å°å›¢é˜Ÿä½¿ç”¨ | $5-10/æœˆ |
| **æ ‘è“æ´¾** | å®¶åº­å†…ç½‘ä½¿ç”¨ | ä¸€æ¬¡æ€§ç¡¬ä»¶æˆæœ¬ |
| **NAS** | å®¶åº­ 24h è¿è¡Œ | å·²æœ‰è®¾å¤‡æ— é¢å¤–æˆæœ¬ |
| **Cloudflare Workers** | å…è´¹é¢åº¦å†…ä½¿ç”¨ | å…è´¹ |
| **Vercel/Railway** | å…è´¹é¢åº¦å†…ä½¿ç”¨ | å…è´¹/æŒ‰é‡ä»˜è´¹ |

---

#### è½¯ä»¶ç¯å¢ƒè¦æ±‚

| è½¯ä»¶ | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| **Node.js** | >= 16.x | æ¨è 18.x LTS æˆ– 20.x LTS |
| **pnpm** | >= 7.x | åŒ…ç®¡ç†å™¨ï¼ˆå¿…éœ€ï¼‰ |
| **Git** | ä»»æ„ç‰ˆæœ¬ | ç”¨äºå…‹éš†ä»£ç  |

##### å¯é€‰è½¯ä»¶

| è½¯ä»¶ | ç”¨é€” |
|------|------|
| **Nginx/Caddy** | åå‘ä»£ç†ã€HTTPSã€åŸŸåç»‘å®š |
| **PM2** | è¿›ç¨‹ç®¡ç†ã€è‡ªåŠ¨é‡å¯ |
| **Docker** | å®¹å™¨åŒ–éƒ¨ç½² |

---

#### å®‰è£…æ­¥éª¤

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/sub-store-org/Sub-Store.git
cd Sub-Store/backend

# 2. å®‰è£… pnpmï¼ˆå¦‚æœªå®‰è£…ï¼‰
npm install -g pnpm

# 3. å®‰è£…ä¾èµ–
pnpm install

# 4. æ„å»ºé¡¹ç›®
pnpm bundle:esbuild

# 5. è¿è¡ŒæœåŠ¡
node sub-store.min.js
```

#### ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶æˆ–è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š

```bash
# åç«¯é…ç½®
SUB_STORE_BACKEND_API_PORT=3000          # API ç«¯å£
SUB_STORE_BACKEND_API_HOST=::            # ç›‘å¬åœ°å€ï¼ˆ:: è¡¨ç¤ºæ‰€æœ‰åœ°å€ï¼‰

# å‰ç«¯é…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºå‰åç«¯åˆå¹¶éƒ¨ç½²ï¼‰
SUB_STORE_FRONTEND_PATH=/path/to/frontend  # å‰ç«¯æ–‡ä»¶è·¯å¾„
SUB_STORE_FRONTEND_PORT=3001               # å‰ç«¯ç«¯å£
SUB_STORE_FRONTEND_HOST=::                 # å‰ç«¯ç›‘å¬åœ°å€
SUB_STORE_FRONTEND_BACKEND_PATH=/api       # åç«¯ API è·¯å¾„å‰ç¼€
SUB_STORE_BACKEND_MERGE=true               # å‰åç«¯åˆå¹¶æ¨¡å¼

# å®šæ—¶ä»»åŠ¡é…ç½®
SUB_STORE_BACKEND_SYNC_CRON="0 */6 * * *"  # æ¯6å°æ—¶åŒæ­¥ä¸€æ¬¡
SUB_STORE_PRODUCE_CRON="0 */2 * * *,sub,è®¢é˜…å"  # å®šæ—¶å¤„ç†è®¢é˜…

# æ•°æ®æ¢å¤
SUB_STORE_DATA_URL=https://example.com/backup.json  # å¯åŠ¨æ—¶æ¢å¤æ•°æ®

# GeoIP æ•°æ®åº“æ›´æ–°
SUB_STORE_MMDB_CRON="0 0 * * 0"            # æ¯å‘¨æ—¥æ›´æ–°
SUB_STORE_MMDB_COUNTRY_PATH=/path/to/Country.mmdb
SUB_STORE_MMDB_COUNTRY_URL=https://example.com/Country.mmdb
SUB_STORE_MMDB_ASN_PATH=/path/to/ASN.mmdb
SUB_STORE_MMDB_ASN_URL=https://example.com/ASN.mmdb
```

#### å¼€å‘æ¨¡å¼

```bash
cd backend
pnpm install
SUB_STORE_BACKEND_API_PORT=3000 pnpm run --parallel "/^dev:.*/"
```

---

### 5.3 Docker éƒ¨ç½²

#### åŸºç¡€éƒ¨ç½²

```bash
# ä½¿ç”¨ GitHub Container Registry é•œåƒ
docker run -d \
  --name sub-store \
  --restart always \
  -p 3000:3000 \
  -v /path/to/data:/data \
  ghcr.io/moearly/sub-store
```

#### å¸¦å‰ç«¯çš„å®Œæ•´éƒ¨ç½²

```bash
docker run -d \
  --name sub-store \
  --restart always \
  -p 3000:3000 \
  -e SUB_STORE_FRONTEND_PATH=/frontend \
  -e SUB_STORE_BACKEND_MERGE=true \
  -v /path/to/data:/data \
  ghcr.io/moearly/sub-store
```

#### Docker Compose

```yaml
version: '3'
services:
  sub-store:
    image: ghcr.io/moearly/sub-store
    container_name: sub-store
    restart: always
    ports:
      - "3000:3000"
    volumes:
      - ./data:/data
    environment:
      - SUB_STORE_BACKEND_API_PORT=3000
      - SUB_STORE_FRONTEND_PATH=/frontend
      - SUB_STORE_BACKEND_MERGE=true
```

---

### 5.4 Zeabur äº‘å¹³å°éƒ¨ç½²

[Zeabur](https://zeabur.com/) æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„äº‘éƒ¨ç½²å¹³å°ï¼Œæ”¯æŒä¸€é”®éƒ¨ç½² Node.js åº”ç”¨ï¼Œéå¸¸é€‚åˆéƒ¨ç½² Sub-Storeã€‚

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Docker é•œåƒéƒ¨ç½²ï¼ˆæ¨èï¼‰

##### æ­¥éª¤ 1ï¼šæ³¨å†Œå¹¶ç™»å½• Zeabur

1. è®¿é—® [Zeabur å®˜ç½‘](https://zeabur.com/)
2. ä½¿ç”¨ GitHub è´¦å·ç™»å½•ï¼ˆæ¨èï¼‰æˆ–é‚®ç®±æ³¨å†Œ

##### æ­¥éª¤ 2ï¼šåˆ›å»ºé¡¹ç›®

1. ç‚¹å‡»æ§åˆ¶å°å³ä¸Šè§’çš„ã€ŒCreate Projectã€
2. é€‰æ‹©ä¸€ä¸ªåŒºåŸŸï¼ˆæ¨èé€‰æ‹©ç¦»ä½ è¾ƒè¿‘çš„åŒºåŸŸï¼‰
3. è¾“å…¥é¡¹ç›®åç§°ï¼Œå¦‚ `sub-store`

##### æ­¥éª¤ 3ï¼šæ·»åŠ æœåŠ¡

1. åœ¨é¡¹ç›®ä¸­ç‚¹å‡»ã€ŒAdd Serviceã€
2. é€‰æ‹©ã€ŒPrebuiltã€->ã€ŒDockerã€
3. è¾“å…¥ Docker é•œåƒï¼š`ghcr.io/moearly/sub-store`
4. ç‚¹å‡»ã€ŒDeployã€

##### æ­¥éª¤ 4ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨æœåŠ¡çš„ã€ŒVariablesã€é€‰é¡¹å¡ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | å€¼ | è¯´æ˜ |
|--------|------|------|
| `SUB_STORE_BACKEND_API_PORT` | `3000` | åç«¯ç«¯å£ï¼ˆå¿…éœ€ï¼‰ |
| `SUB_STORE_FRONTEND_PATH` | `/frontend` | å‰ç«¯è·¯å¾„ |
| `SUB_STORE_BACKEND_MERGE` | `true` | å‰åç«¯åˆå¹¶æ¨¡å¼ |

##### æ­¥éª¤ 5ï¼šé…ç½®ç«¯å£

1. åœ¨ã€ŒNetworkingã€é€‰é¡¹å¡ä¸­
2. æ·»åŠ ç«¯å£æ˜ å°„ï¼š`3000`
3. å¼€å¯ã€ŒPublicã€ä½¿æœåŠ¡å¯å…¬å¼€è®¿é—®

##### æ­¥éª¤ 6ï¼šç»‘å®šåŸŸå

1. åœ¨ã€ŒNetworkingã€->ã€ŒDomainsã€ä¸­
2. å¯ä»¥ä½¿ç”¨ Zeabur æä¾›çš„å…è´¹å­åŸŸåï¼ˆå¦‚ `xxx.zeabur.app`ï¼‰
3. æˆ–ç»‘å®šè‡ªå·±çš„åŸŸå

##### æ­¥éª¤ 7ï¼šé…ç½®æŒä¹…åŒ–å­˜å‚¨ï¼ˆé‡è¦ï¼‰

1. åœ¨ã€ŒStorageã€é€‰é¡¹å¡ä¸­
2. æ·»åŠ æŒä¹…åŒ–å·ï¼šæŒ‚è½½è·¯å¾„ `/data`
3. è¿™æ ·æ•°æ®ä¸ä¼šå› ä¸ºé‡æ–°éƒ¨ç½²è€Œä¸¢å¤±

---

#### æ–¹å¼äºŒï¼šä» GitHub ä»“åº“éƒ¨ç½²

##### æ­¥éª¤ 1ï¼šFork ä»“åº“

1. è®¿é—® [Sub-Store GitHub](https://github.com/sub-store-org/Sub-Store)
2. ç‚¹å‡»å³ä¸Šè§’ã€ŒForkã€æŒ‰é’®
3. Fork åˆ°ä½ è‡ªå·±çš„ GitHub è´¦å·

##### æ­¥éª¤ 2ï¼šåˆ›å»ºé¡¹ç›®å¹¶éƒ¨ç½²

1. åœ¨ Zeabur ä¸­åˆ›å»ºæ–°é¡¹ç›®
2. ç‚¹å‡»ã€ŒAdd Serviceã€->ã€ŒGitã€
3. é€‰æ‹©ä½  Fork çš„ Sub-Store ä»“åº“
4. è®¾ç½®æ ¹ç›®å½•ä¸º `backend`
5. ç‚¹å‡»ã€ŒDeployã€

##### æ­¥éª¤ 3ï¼šé…ç½®æ„å»ºå‘½ä»¤

åœ¨ã€ŒBuildã€é€‰é¡¹å¡ä¸­è®¾ç½®ï¼š

| é…ç½®é¡¹ | å€¼ |
|--------|------|
| **Build Command** | `npm install -g pnpm && pnpm install && pnpm bundle:esbuild` |
| **Start Command** | `node sub-store.min.js` |
| **Root Directory** | `backend` |

##### æ­¥éª¤ 4ï¼šé…ç½®ç¯å¢ƒå˜é‡

åŒæ–¹å¼ä¸€çš„æ­¥éª¤ 4ã€‚

---

#### Zeabur éƒ¨ç½²å®Œæ•´é…ç½®ç¤ºä¾‹

```yaml
# zeabur.yamlï¼ˆå¯é€‰ï¼Œæ”¾åœ¨ä»“åº“æ ¹ç›®å½•ï¼‰
build:
  root: backend
  command: npm install -g pnpm && pnpm install && pnpm bundle:esbuild
start:
  command: node sub-store.min.js
env:
  SUB_STORE_BACKEND_API_PORT: "3000"
  SUB_STORE_FRONTEND_PATH: "/frontend"
  SUB_STORE_BACKEND_MERGE: "true"
```

---

#### Zeabur è´¹ç”¨è¯´æ˜

| è®¡åˆ’ | è´¹ç”¨ | èµ„æºé™åˆ¶ |
|------|------|----------|
| **Free** | å…è´¹ | å…±äº«èµ„æºï¼Œæœ‰ä½¿ç”¨æ—¶é•¿é™åˆ¶ |
| **Developer** | $5/æœˆèµ· | æ›´å¤šèµ„æºï¼Œæ— æ—¶é•¿é™åˆ¶ |
| **Team** | æŒ‰éœ€ä»˜è´¹ | å›¢é˜Ÿåä½œåŠŸèƒ½ |

> **æç¤º**ï¼šå…è´¹è®¡åˆ’è¶³å¤Ÿä¸ªäººä½¿ç”¨ï¼Œä½†å¯èƒ½æœ‰å†·å¯åŠ¨å»¶è¿Ÿã€‚

---

#### Zeabur éƒ¨ç½²ä¼˜åŠ¿

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| âœ… ä¸€é”®éƒ¨ç½² | æ— éœ€æœåŠ¡å™¨è¿ç»´çŸ¥è¯† |
| âœ… è‡ªåŠ¨ HTTPS | å…è´¹ SSL è¯ä¹¦ |
| âœ… è‡ªåŠ¨æ‰©ç¼©å®¹ | æŒ‰éœ€åˆ†é…èµ„æº |
| âœ… æŒä¹…åŒ–å­˜å‚¨ | æ•°æ®ä¸ä¸¢å¤± |
| âœ… å…¨çƒèŠ‚ç‚¹ | å¤šåŒºåŸŸå¯é€‰ |
| âœ… GitHub é›†æˆ | è‡ªåŠ¨éƒ¨ç½²æ›´æ–° |

---

### 5.5 å…¶ä»–äº‘å¹³å°éƒ¨ç½²

#### Vercel éƒ¨ç½²

Vercel ä¸»è¦é€‚åˆé™æ€ç½‘ç«™å’Œ Serverless å‡½æ•°ï¼ŒSub-Store ä½œä¸ºæŒä¹…åŒ–æœåŠ¡ä¸å¤ªé€‚åˆã€‚

#### Railway éƒ¨ç½²

```bash
# ä½¿ç”¨ Railway CLI
railway login
railway init
railway up
```

ç¯å¢ƒå˜é‡é…ç½®åŒä¸Šã€‚

#### Render éƒ¨ç½²

1. åœ¨ Render åˆ›å»º Web Service
2. è¿æ¥ GitHub ä»“åº“
3. è®¾ç½® Root Directory: `backend`
4. Build Command: `npm install -g pnpm && pnpm install && pnpm bundle:esbuild`
5. Start Command: `node sub-store.min.js`

---

### 5.6 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®

#### ä½¿ç”¨ PM2 ç®¡ç†è¿›ç¨‹

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start sub-store.min.js --name sub-store

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save

# å¸¸ç”¨å‘½ä»¤
pm2 status          # æŸ¥çœ‹çŠ¶æ€
pm2 logs sub-store  # æŸ¥çœ‹æ—¥å¿—
pm2 restart sub-store  # é‡å¯æœåŠ¡
```

#### ä½¿ç”¨ Nginx åå‘ä»£ç†

```nginx
server {
    listen 80;
    server_name sub.example.com;
    
    # é‡å®šå‘åˆ° HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name sub.example.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # WebSocket æ”¯æŒï¼ˆå¦‚éœ€è¦ï¼‰
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

#### ä½¿ç”¨ Caddy åå‘ä»£ç†ï¼ˆæ›´ç®€å•ï¼‰

```
sub.example.com {
    reverse_proxy localhost:3000
}
```

#### Systemd æœåŠ¡ï¼ˆä¸ä½¿ç”¨ PM2 æ—¶ï¼‰

åˆ›å»º `/etc/systemd/system/sub-store.service`ï¼š

```ini
[Unit]
Description=Sub-Store Service
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/opt/sub-store/backend
ExecStart=/usr/bin/node sub-store.min.js
Restart=on-failure
RestartSec=10
Environment=SUB_STORE_BACKEND_API_PORT=3000

[Install]
WantedBy=multi-user.target
```

```bash
# å¯ç”¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable sub-store
sudo systemctl start sub-store
```

---

### 5.5 ç½‘ç»œè¦æ±‚

#### ç«¯å£éœ€æ±‚

| ç«¯å£ | ç”¨é€” | æ˜¯å¦å¿…éœ€ |
|------|------|----------|
| 3000 | åç«¯ API é»˜è®¤ç«¯å£ | æ˜¯ï¼ˆå¯ä¿®æ”¹ï¼‰ |
| 3001 | å‰ç«¯é»˜è®¤ç«¯å£ï¼ˆåˆ†ç¦»éƒ¨ç½²æ—¶ï¼‰ | å¦ |
| 80/443 | åå‘ä»£ç†ç«¯å£ | æ¨è |

#### é˜²ç«å¢™é…ç½®

```bash
# UFWï¼ˆUbuntuï¼‰
sudo ufw allow 3000/tcp

# firewalldï¼ˆCentOSï¼‰
sudo firewall-cmd --permanent --add-port=3000/tcp
sudo firewall-cmd --reload

# iptables
sudo iptables -A INPUT -p tcp --dport 3000 -j ACCEPT
```

#### ç½‘ç»œè®¿é—®éœ€æ±‚

| ç›®æ ‡ | ç”¨é€” | æ˜¯å¦å¿…éœ€ |
|------|------|----------|
| è®¢é˜…æº URL | ä¸‹è½½åŸå§‹è®¢é˜… | æ˜¯ |
| GitHub/GitLab | Gist åŒæ­¥ | å¯é€‰ |
| GeoIP æ•°æ®åº“ URL | æ›´æ–° MMDB | å¯é€‰ |

> **æ³¨æ„**ï¼šå¦‚æœæœåŠ¡å™¨æ— æ³•ç›´æ¥è®¿é—®è®¢é˜…æºï¼Œéœ€è¦é…ç½®ä»£ç†ã€‚

---

## å…­ã€ä½¿ç”¨è¯´æ˜

### 6.1 åŸºæœ¬ä½¿ç”¨æµç¨‹

1. **è®¿é—® Web ç•Œé¢**
   - å®¢æˆ·ç«¯éƒ¨ç½²ï¼šè®¿é—® `https://sub.store`
   - æœåŠ¡å™¨éƒ¨ç½²ï¼šè®¿é—® `http://ä½ çš„æœåŠ¡å™¨IP:3000`

2. **æ·»åŠ è®¢é˜…**
   - ç‚¹å‡»ã€Œè®¢é˜…ã€->ã€Œæ·»åŠ ã€
   - å¡«å†™è®¢é˜…åç§°å’Œ URL
   - ä¿å­˜

3. **é…ç½®å¤„ç†è§„åˆ™**
   - æ·»åŠ è¿‡æ»¤å™¨ï¼ˆå¦‚åœ°åŒºè¿‡æ»¤ã€æ­£åˆ™è¿‡æ»¤ï¼‰
   - æ·»åŠ æ“ä½œï¼ˆå¦‚é‡å‘½åã€æ’åºï¼‰

4. **è·å–è½¬æ¢é“¾æ¥**
   - é€‰æ‹©ç›®æ ‡å¹³å°
   - å¤åˆ¶ç”Ÿæˆçš„è®¢é˜…é“¾æ¥
   - åœ¨å¯¹åº”å®¢æˆ·ç«¯ä¸­ä½¿ç”¨

### 6.2 é«˜çº§åŠŸèƒ½

#### ç»„åˆè®¢é˜…

å°†å¤šä¸ªè®¢é˜…åˆå¹¶ä¸ºä¸€ä¸ªï¼š

1. åˆ›å»ºå¤šä¸ªå•æ¡è®¢é˜…
2. åˆ›å»ºç»„åˆè®¢é˜…
3. é€‰æ‹©è¦åˆå¹¶çš„è®¢é˜…
4. é…ç½®ç»„åˆè®¢é˜…çš„å¤„ç†è§„åˆ™

#### è„šæœ¬æ“ä½œ

ä½¿ç”¨ JavaScript è„šæœ¬è‡ªå®šä¹‰å¤„ç†ï¼š

```javascript
// ç¤ºä¾‹ï¼šä¸ºèŠ‚ç‚¹æ·»åŠ å‰ç¼€
function operator(proxies) {
  return proxies.map(proxy => {
    proxy.name = `[è‡ªå®šä¹‰] ${proxy.name}`;
    return proxy;
  });
}
```

#### Gist åŒæ­¥

1. åœ¨è®¾ç½®ä¸­é…ç½® GitHub/GitLab Token
2. åˆ›å»ºåŒæ­¥é…ç½®ï¼ˆArtifactï¼‰
3. å…³è”è®¢é˜…æˆ–ç»„åˆè®¢é˜…
4. æ‰‹åŠ¨æˆ–å®šæ—¶åŒæ­¥åˆ° Gist

---

## ä¸ƒã€å¸¸è§é—®é¢˜

### Q1: è®¢é˜…è½¬æ¢å¤±è´¥ï¼Ÿ

- æ£€æŸ¥åŸå§‹è®¢é˜… URL æ˜¯å¦å¯è®¿é—®
- æ£€æŸ¥è®¢é˜…æ ¼å¼æ˜¯å¦è¢«æ”¯æŒ
- æŸ¥çœ‹æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

### Q2: èŠ‚ç‚¹ä¸¢å¤±ï¼Ÿ

- æ£€æŸ¥è¿‡æ»¤å™¨è§„åˆ™æ˜¯å¦è¿‡äºä¸¥æ ¼
- ç¡®è®¤èŠ‚ç‚¹åè®®æ˜¯å¦è¢«ç›®æ ‡å¹³å°æ”¯æŒ

### Q3: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ

- ä½¿ç”¨ Gist åŒæ­¥åŠŸèƒ½
- å¯¼å‡ºè®¢é˜…é…ç½®ä¸º JSON æ–‡ä»¶

### Q4: å¦‚ä½•æ›´æ–° Sub-Storeï¼Ÿ

- å®¢æˆ·ç«¯éƒ¨ç½²ï¼šæ›´æ–°æ¨¡å—/æ’ä»¶å³å¯
- æœåŠ¡å™¨éƒ¨ç½²ï¼šæ‹‰å–æœ€æ–°ä»£ç é‡æ–°æ„å»º

---

## å…«ã€èŠ‚ç‚¹ä¼˜åŒ–ä¸åˆ†æµç­–ç•¥

### 8.1 èŠ‚ç‚¹è¿‡æ»¤è§„åˆ™

#### æ­£åˆ™è¿‡æ»¤ï¼ˆä¿ç•™åŒ¹é…çš„èŠ‚ç‚¹ï¼‰

| åœºæ™¯ | æ­£åˆ™è¡¨è¾¾å¼ |
|------|------------|
| åªä¿ç•™é¦™æ¸¯èŠ‚ç‚¹ | `é¦™æ¸¯\|HK\|Hong Kong\|ğŸ‡­ğŸ‡°` |
| åªä¿ç•™æ—¥æœ¬èŠ‚ç‚¹ | `æ—¥æœ¬\|JP\|Japan\|ğŸ‡¯ğŸ‡µ` |
| åªä¿ç•™ç¾å›½èŠ‚ç‚¹ | `ç¾å›½\|US\|United States\|ğŸ‡ºğŸ‡¸` |
| ä¿ç•™äºšæ´²èŠ‚ç‚¹ | `é¦™æ¸¯\|å°æ¹¾\|æ—¥æœ¬\|æ–°åŠ å¡\|éŸ©å›½` |

#### æ’é™¤è¿‡æ»¤ï¼ˆç§»é™¤åŒ¹é…çš„èŠ‚ç‚¹ï¼‰

| åœºæ™¯ | æ­£åˆ™è¡¨è¾¾å¼ |
|------|------------|
| ç§»é™¤æ— ç”¨ä¿¡æ¯ | `è¿‡æœŸ\|åˆ°æœŸ\|å‰©ä½™\|æµé‡\|å®˜ç½‘\|ç¾¤\|é¢‘é“\|è®¢é˜…` |
| ç§»é™¤å€ç‡èŠ‚ç‚¹ | `[2-9](\\.\\d+)?[xXå€]` |
| ç§»é™¤ç‰¹å®šåœ°åŒº | `ä¿„ç½—æ–¯\|å°åº¦\|å·´è¥¿` |

### 8.2 èŠ‚ç‚¹é‡å‘½å

#### æ­£åˆ™é‡å‘½åç¤ºä¾‹

| åŸåç§° | æ­£åˆ™ | æ›¿æ¢ | ç»“æœ |
|--------|------|------|------|
| `é¦™æ¸¯01` | `é¦™æ¸¯(\\d+)` | `ğŸ‡­ğŸ‡° HK-$1` | `ğŸ‡­ğŸ‡° HK-01` |
| `æ—¥æœ¬ ä¸œäº¬ 01` | `æ—¥æœ¬.*?(\\d+)` | `ğŸ‡¯ğŸ‡µ JP-$1` | `ğŸ‡¯ğŸ‡µ JP-01` |
| `[SS]é¦™æ¸¯èŠ‚ç‚¹` | `\\[.*?\\](.*)` | `$1` | `é¦™æ¸¯èŠ‚ç‚¹` |

### 8.3 èŠ‚ç‚¹æ’åº

#### æŒ‰åœ°åŒºä¼˜å…ˆçº§æ’åº

```
é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,éŸ©å›½,ç¾å›½,å…¶ä»–
```

#### æŒ‰å»¶è¿Ÿæ’åº

ä½¿ç”¨è„šæœ¬æ“ä½œï¼ŒæŒ‰èŠ‚ç‚¹å»¶è¿Ÿè‡ªåŠ¨æ’åºã€‚

### 8.4 æ¨èå¤„ç†æµç¨‹

```
åŸå§‹è®¢é˜…
    â†“
1. æ’é™¤è¿‡æ»¤ï¼šç§»é™¤æ— ç”¨èŠ‚ç‚¹ï¼ˆå®˜ç½‘ã€ç¾¤ç»„ã€è¿‡æœŸç­‰ï¼‰
    â†“
2. æ­£åˆ™è¿‡æ»¤ï¼šä¿ç•™éœ€è¦çš„åœ°åŒºï¼ˆå¯é€‰ï¼‰
    â†“
3. é‡å‘½åï¼šç»Ÿä¸€èŠ‚ç‚¹åç§°æ ¼å¼
    â†“
4. æ·»åŠ å›½æ——ï¼šFlag æ“ä½œ
    â†“
5. å»é‡ï¼šç§»é™¤é‡å¤èŠ‚ç‚¹
    â†“
6. æ’åºï¼šæŒ‰åœ°åŒº/åç§°æ’åº
    â†“
è¾“å‡ºè®¢é˜…
```

### 8.5 ç»„åˆè®¢é˜…åˆ†ç»„ç­–ç•¥

åˆ›å»ºå¤šä¸ªç»„åˆè®¢é˜…ï¼Œç”¨äºä¸åŒåœºæ™¯ï¼š

| ç»„åˆåç§° | è¿‡æ»¤è§„åˆ™ | ç”¨é€” |
|----------|----------|------|
| `å…¨éƒ¨èŠ‚ç‚¹` | æ— è¿‡æ»¤ | å¤‡ç”¨ |
| `é¦™æ¸¯ä¸“çº¿` | `é¦™æ¸¯\|HK` | ä½å»¶è¿Ÿã€çœ‹æ¸¯å‰§ |
| `æ—¥æœ¬ä¸“çº¿` | `æ—¥æœ¬\|JP` | åŠ¨æ¼«ã€æ¸¸æˆ |
| `ç¾å›½ä¸“çº¿` | `ç¾å›½\|US` | ChatGPTã€Netflix |
| `ä½å»¶è¿Ÿ` | `é¦™æ¸¯\|å°æ¹¾\|æ—¥æœ¬\|æ–°åŠ å¡` | æ—¥å¸¸ä½¿ç”¨ |
| `è§£é”æµåª’ä½“` | `è§£é”\|Netflix\|Disney` | æµåª’ä½“ä¸“ç”¨ |

### 8.6 Clash åˆ†æµè§„åˆ™ç¤ºä¾‹

```yaml
proxy-groups:
  - name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
      - DIRECT

  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies: []  # ä½¿ç”¨å…¨éƒ¨èŠ‚ç‚¹

  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    filter: "é¦™æ¸¯|HK|ğŸ‡­ğŸ‡°"

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    filter: "æ—¥æœ¬|JP|ğŸ‡¯ğŸ‡µ"

  - name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    filter: "ç¾å›½|US|ğŸ‡ºğŸ‡¸"

  - name: ğŸ¤– AI æœåŠ¡
    type: select
    proxies:
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©

  - name: ğŸ“º æµåª’ä½“
    type: select
    proxies:
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹

rules:
  # AI æœåŠ¡
  - DOMAIN-SUFFIX,openai.com,ğŸ¤– AI æœåŠ¡
  - DOMAIN-SUFFIX,anthropic.com,ğŸ¤– AI æœåŠ¡
  - DOMAIN-SUFFIX,claude.ai,ğŸ¤– AI æœåŠ¡
  
  # æµåª’ä½“
  - DOMAIN-SUFFIX,netflix.com,ğŸ“º æµåª’ä½“
  - DOMAIN-SUFFIX,youtube.com,ğŸ“º æµåª’ä½“
  - DOMAIN-SUFFIX,spotify.com,ğŸ“º æµåª’ä½“
  
  # ç¤¾äº¤åª’ä½“
  - DOMAIN-SUFFIX,twitter.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,instagram.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,facebook.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  
  # å¼€å‘å·¥å…·
  - DOMAIN-SUFFIX,github.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,githubusercontent.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  
  # å›½å†…ç›´è¿
  - GEOIP,CN,DIRECT
  
  # é»˜è®¤
  - MATCH,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
```

### 8.7 è„šæœ¬æ“ä½œç¤ºä¾‹

#### æ·»åŠ èŠ‚ç‚¹å‰ç¼€

```javascript
function operator(proxies) {
  return proxies.map(proxy => {
    proxy.name = `[ä¼˜åŒ–] ${proxy.name}`;
    return proxy;
  });
}
```

#### æŒ‰å»¶è¿Ÿè¿‡æ»¤ï¼ˆç§»é™¤é«˜å»¶è¿ŸèŠ‚ç‚¹ï¼‰

```javascript
async function operator(proxies, targetPlatform, context) {
  // ç§»é™¤åç§°ä¸­åŒ…å«é«˜å»¶è¿Ÿæ ‡è¯†çš„èŠ‚ç‚¹
  return proxies.filter(proxy => {
    return !proxy.name.includes('é«˜å»¶è¿Ÿ') && !proxy.name.includes('æ…¢');
  });
}
```

#### èŠ‚ç‚¹å»é‡ï¼ˆæŒ‰æœåŠ¡å™¨+ç«¯å£ï¼‰

```javascript
function operator(proxies) {
  const seen = new Set();
  return proxies.filter(proxy => {
    const key = `${proxy.server}:${proxy.port}`;
    if (seen.has(key)) return false;
    seen.add(key);
    return true;
  });
}
```

---

## ä¹ã€Mihomo åˆ†æµé…ç½®è„šæœ¬

ä»¥ä¸‹æ˜¯ç”¨äº Sub-Storeã€ŒMihomo é…ç½®ã€ç±»å‹çš„å®Œæ•´åˆ†æµè„šæœ¬ï¼Œå®ç°ï¼š
- **Cursor** â†’ äºšæ´²èŠ‚ç‚¹ï¼ˆä½å»¶è¿Ÿï¼‰
- **OpenAI/ChatGPT/Gemini/Claude** â†’ ç¾å›½èŠ‚ç‚¹
- **SSH 22 ç«¯å£** â†’ ç›´è¿ï¼ˆä¸èµ°ä»£ç†ï¼‰

### 9.1 å®Œæ•´è„šæœ¬ä»£ç 

```javascript
// Cursor + AI åˆ†æµé…ç½®è„šæœ¬
// ä¸º Mihomo/Clash Meta æ·»åŠ åˆ†æµè§„åˆ™

// ä»è®¢é˜…è·å–èŠ‚ç‚¹ï¼ˆè¯·å°† 'ç™½æœˆå…‰' æ›¿æ¢ä¸ºä½ çš„è®¢é˜…åç§°ï¼‰
let proxies = await produceArtifact({
  type: 'subscription',
  name: 'ç™½æœˆå…‰',
  platform: 'ClashMeta',
  produceType: 'internal'
});

// è·å–æ‰€æœ‰èŠ‚ç‚¹åç§°
const allProxies = proxies?.map(p => p.name) || [];

// ç­›é€‰äºšæ´²èŠ‚ç‚¹
const asiaFilter = /é¦™æ¸¯|å°æ¹¾|æ—¥æœ¬|æ–°åŠ å¡|éŸ©å›½|HK|TW|JP|SG|KR/i;
const asiaProxies = allProxies.filter(n => asiaFilter.test(n));

// ç­›é€‰ç¾å›½èŠ‚ç‚¹
const usFilter = /ç¾å›½|US|United States/i;
const usProxies = allProxies.filter(n => usFilter.test(n));

// ç­›é€‰æ—¥æœ¬èŠ‚ç‚¹
const jpFilter = /æ—¥æœ¬|JP|Japan|ä¸œäº¬|å¤§é˜ª/i;
const jpProxies = allProxies.filter(n => jpFilter.test(n));

// æ‰“åŒ…èŠ‚ç‚¹ï¼ˆç¾å›½ + æ—¥æœ¬ï¼‰
const bundleProxies = [...usProxies, ...jpProxies];

// ç¡®ä¿æœ‰èŠ‚ç‚¹ï¼ˆå¦‚æœç­›é€‰ä¸ºç©ºåˆ™ä½¿ç”¨ DIRECTï¼‰
if (asiaProxies.length === 0) asiaProxies.push('DIRECT');
if (usProxies.length === 0) usProxies.push('DIRECT');
if (jpProxies.length === 0) jpProxies.push('DIRECT');
if (bundleProxies.length === 0) bundleProxies.push('DIRECT');

// æ„å»ºå®Œæ•´çš„ Mihomo é…ç½®
const config = {
  'mixed-port': 7890,
  'allow-lan': false,
  mode: 'rule',
  'log-level': 'info',
  
  proxies: proxies,
  
  'proxy-groups': [
    {
      name: 'ğŸš€ èŠ‚ç‚¹é€‰æ‹©',
      type: 'select',
      proxies: ['ğŸŒ äºšæ´²èŠ‚ç‚¹', 'ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹', 'ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹', 'ğŸ“¦ æ‰“åŒ…èŠ‚ç‚¹', 'DIRECT', ...allProxies]
    },
    {
      name: 'ğŸŒ äºšæ´²èŠ‚ç‚¹',
      type: 'url-test',
      url: 'http://www.gstatic.com/generate_204',
      interval: 300,
      proxies: asiaProxies
    },
    {
      name: 'ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
      type: 'url-test',
      url: 'http://www.gstatic.com/generate_204',
      interval: 300,
      proxies: usProxies
    },
    {
      name: 'ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹',
      type: 'url-test',
      url: 'http://www.gstatic.com/generate_204',
      interval: 300,
      proxies: jpProxies
    },
    {
      name: 'ğŸ“¦ æ‰“åŒ…èŠ‚ç‚¹',
      type: 'url-test',
      url: 'http://www.gstatic.com/generate_204',
      interval: 300,
      proxies: bundleProxies
    }
  ],
  
  rules: [
    // ========== å±€åŸŸç½‘è®¾å¤‡åˆ†æµï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰==========
    // æŒ‡å®š IP èµ°ç‰¹å®šä»£ç†ï¼ˆè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰
    // 'SRC-IP-CIDR,192.168.1.100/32,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',  // å•ä¸ªè®¾å¤‡
    // 'SRC-IP-CIDR,192.168.1.0/24,ğŸŒ äºšæ´²èŠ‚ç‚¹',      // æ•´ä¸ªç½‘æ®µ
    
    // ========== SSH ç›´è¿ ==========
    'DST-PORT,22,DIRECT',
    
    // ========== Cursor èµ°äºšæ´²èŠ‚ç‚¹ ==========
    'DOMAIN-SUFFIX,cursor.sh,ğŸŒ äºšæ´²èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,cursor.so,ğŸŒ äºšæ´²èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,cursorapi.com,ğŸŒ äºšæ´²èŠ‚ç‚¹',
    'DOMAIN-KEYWORD,cursor,ğŸŒ äºšæ´²èŠ‚ç‚¹',
    
    // ========== OpenAI/ChatGPT èµ°ç¾å›½èŠ‚ç‚¹ ==========
    'DOMAIN-SUFFIX,openai.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,chatgpt.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,oaistatic.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,oaiusercontent.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-KEYWORD,openai,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    
    // ========== Google Gemini èµ°ç¾å›½èŠ‚ç‚¹ ==========
    'DOMAIN-SUFFIX,gemini.google.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,generativelanguage.googleapis.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,ai.google.dev,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,aistudio.google.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-KEYWORD,gemini,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    
    // ========== Claude èµ°ç¾å›½èŠ‚ç‚¹ ==========
    'DOMAIN-SUFFIX,anthropic.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    'DOMAIN-SUFFIX,claude.ai,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
    
    // ========== å…œåº•è§„åˆ™ ==========
    'GEOIP,CN,DIRECT',
    'MATCH,ğŸš€ èŠ‚ç‚¹é€‰æ‹©'
  ]
};

$content = ProxyUtils.yaml.dump(config);
```

### 9.2 ä½¿ç”¨æ–¹æ³•

1. åœ¨ Sub-Store ä¸­åˆ›å»ºã€Œ**Mihomo é…ç½®**ã€ç±»å‹çš„æ–‡ä»¶
2. é€‰æ‹©ã€Œ**è„šæœ¬æ“ä½œ**ã€â†’ã€Œ**å¿«æ·è„šæœ¬**ã€
3. å°†ä¸Šè¿°è„šæœ¬ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­
4. **ä¿®æ”¹è®¢é˜…åç§°**ï¼šå°† `'ç™½æœˆå…‰'` æ›¿æ¢ä¸ºä½ å®é™…çš„è®¢é˜…åç§°
5. ç‚¹å‡»ã€Œ**å³æ—¶é¢„è§ˆ**ã€éªŒè¯é…ç½®
6. ç‚¹å‡»ã€Œ**ä¿å­˜**ã€

### 9.3 åˆ†æµè§„åˆ™è¯´æ˜

| è§„åˆ™ç±»å‹ | ç›®æ ‡ | ä»£ç†ç»„ |
|----------|------|--------|
| `SRC-IP-CIDR` | å±€åŸŸç½‘è®¾å¤‡ï¼ˆæº IPï¼‰ | è‡ªå®šä¹‰ |
| `DST-PORT,22` | SSH è¿æ¥ | DIRECTï¼ˆç›´è¿ï¼‰ |
| `DOMAIN-*,cursor*` | Cursor IDE | ğŸŒ äºšæ´²èŠ‚ç‚¹ |
| `DOMAIN-*,openai*` | OpenAI/ChatGPT | ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹ |
| `DOMAIN-*,gemini*` | Google Gemini | ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹ |
| `DOMAIN-*,claude*` | Anthropic Claude | ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹ |
| `GEOIP,CN` | ä¸­å›½ IP | DIRECTï¼ˆç›´è¿ï¼‰ |
| `MATCH` | å…¶ä»–æµé‡ | ğŸš€ èŠ‚ç‚¹é€‰æ‹© |

### 9.4 è‡ªå®šä¹‰æ‰©å±•

#### å±€åŸŸç½‘è®¾å¤‡åˆ†æµï¼ˆåŸºäºæº IPï¼‰

```javascript
// å•ä¸ªè®¾å¤‡èµ°ç¾å›½èŠ‚ç‚¹ï¼ˆ/32 è¡¨ç¤ºå•ä¸ª IPï¼‰
'SRC-IP-CIDR,192.168.1.100/32,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',

// å•ä¸ªè®¾å¤‡èµ°äºšæ´²èŠ‚ç‚¹
'SRC-IP-CIDR,192.168.1.101/32,ğŸŒ äºšæ´²èŠ‚ç‚¹',

// å•ä¸ªè®¾å¤‡ç›´è¿ï¼ˆä¸èµ°ä»£ç†ï¼‰
'SRC-IP-CIDR,192.168.1.102/32,DIRECT',

// æ•´ä¸ªç½‘æ®µèµ°ä»£ç†ï¼ˆ/24 è¡¨ç¤º 192.168.1.0-255ï¼‰
'SRC-IP-CIDR,192.168.1.0/24,ğŸš€ èŠ‚ç‚¹é€‰æ‹©',

// ç‰¹å®šç½‘æ®µç›´è¿
'SRC-IP-CIDR,192.168.2.0/24,DIRECT',
```

> âš ï¸ **æ³¨æ„**ï¼š
> - Clash/Mihomo **ä¸æ”¯æŒ MAC åœ°å€è§„åˆ™**ï¼Œåªèƒ½ç”¨ IP
> - å»ºè®®åœ¨è·¯ç”±å™¨ä¸Šç»™è®¾å¤‡ç»‘å®šå›ºå®š IPï¼ˆDHCP é™æ€åˆ†é…ï¼‰
> - è§„åˆ™æŒ‰é¡ºåºåŒ¹é…ï¼Œè¶Šé å‰ä¼˜å…ˆçº§è¶Šé«˜

#### æ·»åŠ æ›´å¤šç›´è¿ç«¯å£

```javascript
// åœ¨ rules æ•°ç»„å¼€å¤´æ·»åŠ 
'DST-PORT,22,DIRECT',    // SSH
'DST-PORT,3389,DIRECT',  // RDP è¿œç¨‹æ¡Œé¢
'DST-PORT,5900,DIRECT',  // VNC
'DST-PORT,53,DIRECT',    // DNS
```

#### æ·»åŠ æ›´å¤šåŸŸåè§„åˆ™

```javascript
// GitHub èµ°äºšæ´²èŠ‚ç‚¹
'DOMAIN-SUFFIX,github.com,ğŸŒ äºšæ´²èŠ‚ç‚¹',
'DOMAIN-SUFFIX,githubusercontent.com,ğŸŒ äºšæ´²èŠ‚ç‚¹',

// Telegram èµ°ç¾å›½èŠ‚ç‚¹
'DOMAIN-SUFFIX,telegram.org,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
'DOMAIN-SUFFIX,t.me,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
```

#### ç»„åˆè§„åˆ™ç¤ºä¾‹

```javascript
// ç‰¹å®šè®¾å¤‡ + ç‰¹å®šåŸŸå çš„ç»„åˆåˆ†æµ
// æ³¨æ„ï¼šClash è§„åˆ™æŒ‰é¡ºåºåŒ¹é…ï¼Œå…ˆåŒ¹é…çš„å…ˆç”Ÿæ•ˆ

rules: [
  // 1. è®¾å¤‡ 192.168.1.100 çš„æ‰€æœ‰æµé‡èµ°ç¾å›½èŠ‚ç‚¹
  'SRC-IP-CIDR,192.168.1.100/32,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
  
  // 2. å…¶ä»–è®¾å¤‡è®¿é—® OpenAI èµ°ç¾å›½èŠ‚ç‚¹
  'DOMAIN-SUFFIX,openai.com,ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹',
  
  // 3. å…¶ä»–è®¾å¤‡è®¿é—® Cursor èµ°äºšæ´²èŠ‚ç‚¹
  'DOMAIN-SUFFIX,cursor.sh,ğŸŒ äºšæ´²èŠ‚ç‚¹',
  
  // 4. å›½å†…ç›´è¿
  'GEOIP,CN,DIRECT',
  
  // 5. å…¶ä»–èµ°èŠ‚ç‚¹é€‰æ‹©
  'MATCH,ğŸš€ èŠ‚ç‚¹é€‰æ‹©'
]
```

---

## åã€ç›¸å…³é“¾æ¥

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/sub-store-org/Sub-Store
- **å®˜æ–¹æ–‡æ¡£**: https://xream.notion.site/Sub-Store-abe6a96944724dc6a36833d5c9ab7c87
- **Wiki**: https://github.com/sub-store-org/Sub-Store/wiki
- **Telegram é¢‘é“**: https://t.me/cool_scripts
- **é—®é¢˜åé¦ˆ**: https://github.com/sub-store-org/Sub-Store/issues

